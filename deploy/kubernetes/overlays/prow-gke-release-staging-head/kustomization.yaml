apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
bases:
- ../../base
images:
- name: gke.gcr.io/gcp-compute-persistent-disk-csi-driver
  newName: gcr.io/gke-release-staging/gcp-compute-persistent-disk-csi-driver
  newTag: "latest"
- name: gke.gcr.io/csi-provisioner
  newName: quay.io/k8scsi/csi-provisioner
  newTag: "canary"
- name: gke.gcr.io/csi-attacher
  newName: quay.io/k8scsi/csi-attacher
  newTag: "canary"
- name: gke.gcr.io/csi-node-driver-registrar
  newName: quay.io/k8scsi/csi-node-driver-registrar
  newTag: "canary"
- name: gke.gcr.io/csi-resizer
  newName: quay.io/k8scsi/csi-resizer
  newTag: "canary"
patches:
- controller_add_snapshotter.yaml
patchesJson6902:
- target:
    group: rbac.authorization.k8s.io
    version: v1
    kind: ClusterRole
    name: csi-gce-pd-provisioner-role
  path: rbac_add_snapshots_to_provisioner.yaml
resources:
- rbac_add_snapshotter.yaml
# Reapplying namespace transformer to include newly added RBAC rules.
namespace:
  gce-pd-csi-driver
